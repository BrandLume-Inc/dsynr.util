{"version":3,"file":"DsynrSelect.js","sourceRoot":"","sources":["../../ts/components/DsynrSelect.ts"],"names":[],"mappings":"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","sourcesContent":["class DsynrSelect extends DsynrUIIElement {\n\n    content: HTMLSelectElement;\n    private trigger: HTMLElement;\n    private esPrevOpt: HTMLElement;\n\n    private options: HTMLOptionsCollection;\n    private option: HTMLOptionElement;\n\n    private adoptParent: boolean;\n    private showFinder: boolean;\n    private autoExit: boolean;\n    private isActive: boolean;\n\n    private triggerCls: string;\n    private optCls: string;\n    private optClsActive: string;\n    private optionPrefix: string;\n\n    private modal: DsynrModal;\n    private modalPref: object;\n\n    constructor(select: HTMLElement, preferences: object = {}) {\n        super(select, preferences);\n        if (!this.selfAbort) {\n            lfn('DsynrSelect');\n            this.setDefaults();\n            this.setup();\n        }\n    }\n\n    setDefaults(reset: boolean = false): void {\n\n        super.setDefaults();\n\n        lfn('setDefaults');\n\n        this.adoptParent = addProp(this, 'adoptParent', true, reset);\n        this.nameSuffix = addProp(this, 'nameSuffix', DsynrSelect.instances.length.toString(), reset);\n        this.namePrefix = addProp(this, 'namePrefix', 'dsynrEnhancedSelect', reset);\n        this.optionPrefix = addProp(this, 'namePrefix', concatStr([this.namePrefix, 'option'], '-'), reset);\n        this.instanceClass = addProp(this, 'instanceClasses', concatStr([this.namePrefix, 'rounded bg-light shadow p-5']), reset);\n        this.showFinder = addProp(this, 'showFinder', false, reset);\n        this.autoExit = addProp(this, 'autoExit', true, reset);\n        this.isActive = addProp(this, 'isActive', false, reset);\n        this.triggerCls = addProp(this, 'btnCls', concatStr([this.namePrefix, 'trigger btn btn-link'], '-'), reset);\n        this.optCls = addProp(this, 'optCls', concatStr([this.optionPrefix, 'hand p-2']), reset);\n        this.optClsActive = addProp(this, 'optClsActive', 'active bg-warning rounded', reset);\n    }\n\n    setup(): void {\n        lfn('setup');\n        if (this.content.id === '') {\n            this.content.id = 'dsynrSelect-' + DsynrSelect.instances.length;\n        }\n        this.options = this.content.options;\n        this.option = this.options[this.options.selectedIndex];\n        this.setTrigger();\n        l('Select Trigger READY!');\n    }\n\n    show(): void {\n        lfn('show triggered via : ' + this.trigger.id);\n        if (this.isActive) {\n            this.attention();\n        } else {\n            this.instance = addDiv(this.setName('', this.content.id), this.instanceClass);\n            let self: DsynrSelect = this;\n            makeArray(this.options).forEach(function (o: HTMLOptionElement, index: number) {\n                self.addESOption(o, index);\n            });\n\n            this.modalPref = mergeObjs(this.preferences, {'trigger': 'auto', 'parent': this.parent, 'adoptParent': this.adoptParent});\n            this.modal = new DsynrModal(this.instance, this.modalPref);\n            this.setActive();\n        }\n    }\n\n    attention(): void {\n        DsynrSelect.activeInstance = this;\n        this.modal.attention();\n    }\n\n    private update(selectOption: HTMLOptionElement): void {\n        lfn('update');\n        removeClass(this.esPrevOpt, this.optClsActive);\n        this.option = selectOption;\n        addClass(this.option, this.optClsActive);\n        this.esPrevOpt = getElementById(selectOption.id);\n        this.content.selectedIndex = parseInt(getData(selectOption, 'index'));\n        this.trigger.textContent = this.option.innerText;\n        if (this.autoExit) {\n            this.destroy();\n        }\n    }\n\n    private addESOption(o: HTMLOptionElement, i: number): void {\n        lfn('addESOption');\n        let oid: string = concatStr([this.optionPrefix, this.content.id, i], '-');\n        let ocls: string;\n        l(this.esPrevOpt);\n        ocls = (i == this.content.selectedIndex) ? concatStr([this.optCls, this.optClsActive]) : ocls = this.optCls;\n\n        addDiv(oid, ocls, this.instance);\n        if (i == this.option.index) {\n            this.esPrevOpt = getElementById(oid);\n        }\n        let oe: HTMLOptionElement = <HTMLOptionElement>getElementById(oid);\n        oe.textContent = o.text;\n        setData(oe, 'index', o.index.toString());\n\n        let self: DsynrSelect = this;\n        addListener(oe.id, 'click', function () {\n            lclk(oe.id);\n            self.update(oe);\n        });\n    }\n\n    private setTrigger(): void {\n        lfn('addTrigger');\n        this.trigger = addDiv(this.setName('btn', this.content.id), this.triggerCls, <HTMLElement>this.content.parentElement);\n        addText(this.option.text, this.trigger);\n        let self: DsynrSelect = this;\n        addListener(this.trigger.id, 'click', function () {\n            self.show();\n        });\n        hide(this.content);\n    }\n\n    destroy() {\n        lfn('destroy');\n        this.modal.hide(true);\n        this.isActive = false;\n        DsynrSelect.activeInstance = false;\n    }\n\n    protected setActive(): void {\n        lfn('setActive');\n        this.isActive = true;\n        DsynrSelect.activeInstance = this;\n    }\n\n    static auto(selectClass: string = 'dsynrSelect'): void {\n        lfn('auto');\n        makeArray(getElementsByClass(selectClass)).forEach(function (instance) {\n            new DsynrSelect(instance);\n        });\n    }\n}"]}