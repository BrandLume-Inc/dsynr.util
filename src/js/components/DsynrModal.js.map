{"version":3,"file":"DsynrModal.js","sourceRoot":"","sources":["../../ts/components/DsynrModal.ts"],"names":[],"mappings":"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","sourcesContent":["class DsynrModal extends DsynrUIIElement {\n\n    private instanceRoot: HTMLElement;\n    private underlay: HTMLElement;\n    private trigger: string; //\"auto\" => automatically shows as soon as instantiated\n    private rootClasses: string;\n    private underlayClasses: string;\n    private overlayClasses: string;\n    private disableUnderlay: boolean;\n    private useOverlay: boolean;\n    private isOverlayOn: boolean;\n\n    private animateTogether: boolean;\n    private modalAnimate: boolean;\n    private modalAnimationClasses: string;\n\n    constructor(modalContent: HTMLElement, preferences: object = {}) {\n        lfn('DsynrModal');\n        super(modalContent, preferences);\n\n        this.setDefaults();\n        this.setup();\n        if (this.trigger == 'auto') {\n            this.show();\n        }\n    }\n\n    setDefaults(reset: boolean = false): void {\n        lfn('setDefaults');\n\n        let positionClasses: string = 'position-absolute';\n        let alignmentClasses: string = 'top left';\n\n        this.animate = addProp(this, 'animate', true, reset);\n        this.modalAnimate = addProp(this, 'modalAnimate', true, reset);\n        this.animateTogether = addProp(this, 'animateTogether', true, reset);\n        this.isOverlayOn = addProp(this, 'isOverlayOn', false, reset);\n        this.useOverlay = addProp(this, 'useOverlay', true, reset);\n        this.disableUnderlay = addProp(this, 'disableUnderlay', true, reset);\n        this.nameSuffix = addProp(this, 'nameSuffix', DsynrModal.instances.length.toString(), reset);\n        this.namePrefix = addProp(this, 'namePrefix', 'dsynrModal', reset);\n        this.animationClasses = addProp(this, 'animationClasses', 'animated fadeInDown', reset);\n        this.modalAnimationClasses = addProp(this, 'modalAnimationClasses', 'animated flipInX', reset);\n        this.overlayClasses = addProp(this, 'overlayClasses', 'o50 bg-dark', reset);\n        this.underlayClasses = addProp(this, 'underlayClasses', concatStr([positionClasses, alignmentClasses, 'z1 wmax hmax']), reset);\n        this.instanceClasses = addProp(this, 'instanceClasses', concatStr([positionClasses, 'z2']), reset);\n        this.rootClasses = addProp(this, 'rootClasses', concatStr([positionClasses, alignmentClasses, 'z3 o0 d-none']), reset);\n        this.trigger = addProp(this, 'trigger', 'auto', reset);\n    }\n\n    setup(): void {\n        lfn('setup');\n\n        if (typeof this.parent === 'string') {\n            if (this.parent == 'parent') {\n                this.parent = <HTMLElement>this.content.parentElement;\n            } else {\n                this.parent = getElementById(this.parent);\n            }\n        }\n        let self: DsynrModal = this;\n        if (this.trigger != 'auto') {\n            l('setting trigger to : ' + this.trigger);\n            addListener(this.trigger, 'click', function () {\n                self.show();\n            });\n        }\n        l('Modal Trigger READY!');\n    }\n\n    /**\n     * @todo\n     * add animationEnd listener for root and then animate modal\n     * add optional animationEnd listener for modal\n     */\n    show(): void {\n        lfn('show triggered via : ' + this.trigger);\n\n        l(this);\n        this.instanceRoot = addDiv(this.setName('root', this.content.id), this.rootClasses, this.parent);\n\n        if (this.disableUnderlay) {\n            this.instanceRoot.style.width = getCssDimension(this.parent.clientWidth);\n            this.instanceRoot.style.height = getCssDimension(this.parent.clientHeight);\n\n            if (this.useOverlay) {\n                this.underlayClasses = concatStr([this.underlayClasses, this.overlayClasses]);\n            }\n\n            this.underlay = addDiv(this.setName('underlay', this.content.id), this.underlayClasses, this.instanceRoot);\n        }\n\n        this.instance = addDiv(this.setName('modal', this.parent.id), this.instanceClasses, this.instanceRoot);\n\n        this.addListeners();\n        //update to detect parent (parent) resizing opposed to just window\n        this.instance.appendChild(this.content);\n        // window.addEventListener('resize', function () {\n        //     modals[modals.length].align();\n        // });\n\n\n        removeClass(this.instanceRoot, 'd-none');\n        this.align();\n        if (this.animate) {\n            addClass(this.instanceRoot, this.animationClasses);\n            if (this.animateTogether) {\n                addClass(this.instance, this.modalAnimationClasses);\n            } else {\n                //@todo animationEnd\n            }\n        } else {\n            removeClass(this.instanceRoot, 'o0');\n        }\n        this.setActive();\n    }\n\n    hide(): void {\n        lfn('hide');\n        if (this.isOverlayOn) {\n            this.hideBlanket();\n            removeClass(this.instanceRoot, 'zoomIn');\n            addClass(this.instanceRoot, 'zoomOut');\n        }\n    }\n\n    destroy(): void {\n        throw new Error(\"Method not implemented.\");\n    }\n\n    setActive(): void {\n        lfn('setActive');\n        this.instanceRoot = this.instanceRoot;\n        this.content.focus();\n    }\n\n    addListeners() {\n        lfn('addListeners');\n        let self: DsynrModal = this;\n        if (this.animate) {\n            l('enabling animation');\n            this.instance.addEventListener(transitionEvent, self.modalHidden);\n        }\n    }\n\n    showBlanket(): void {\n        let blanket: HTMLElement;\n        blanket = addDiv('blanket', this.overlayClasses, document.body);\n        addDiv('blanketcoat', this.underlayClasses, blanket);\n        blanket.classList.remove('o0');\n        blanket.addEventListener(transitionEvent, this.blanketHidden);\n        this.isOverlayOn = true;\n    }\n\n    hideBlanket(): void {\n        let blanket: HTMLElement;\n        blanket = getElementById('blanket');\n        blanket.classList.remove('fadeIn');\n        blanket.classList.add('fadeOut');\n    }\n\n    blanketHidden(event): void {\n        // Do something when the transition ends\n        let blanket: HTMLElement;\n        blanket = getElementById('blanket');\n        if (event.animationName == 'fadeOut') {\n            blanket.removeEventListener(transitionEvent, this.blanketHidden);\n            blanket.remove();\n            this.isOverlayOn = false;\n        }\n    }\n\n    align(): void {\n        lfn('align');\n        centereStage(this.instance);\n    }\n\n    private modalHidden(event): void {\n        // Do something when the transition ends\n        if (event.animationName == 'zoomOut') {\n            this.instanceRoot.classList.add('d-none');\n            this.instanceRoot.classList.remove('zoomOut');\n            this.instanceRoot.removeEventListener(transitionEvent, this.modalHidden);\n        }\n    }\n}\n\nfunction autoModalize(modalClass: string = 'dsynrModal'): void {\n    lfn('autoModalize');\n    makeArray(getElementsByClass(modalClass)).forEach(function (modal, index) {\n        new DsynrModal(modal);\n    });\n}"]}